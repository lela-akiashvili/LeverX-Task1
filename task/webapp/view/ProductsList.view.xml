<mvc:View
  controllerName="task.controller.ProductsList"
  xmlns="sap.m"
  xmlns:mvc="sap.ui.core.mvc"
  xmlns:f="sap.f"
  xmlns:form="sap.ui.layout.form"
  xmlns:filterBar="sap.ui.comp.filterbar"
  xmlns:core="sap.ui.core"
  xmlns:formatter="task.utils.formatter">

  <f:DynamicPage id="ProductsList" headerExpanded="true" showFooter="true">
    <f:title>
      <f:DynamicPageTitle>
        <f:heading>
          <Title text="Product List" level="H1" />
        </f:heading>
        <f:breadcrumbs>
          <Breadcrumbs>
            <links>
              <Link text="Home" />
            </links>
          </Breadcrumbs>
        </f:breadcrumbs>
      </f:DynamicPageTitle>
    </f:title>

    <f:header>
      <f:DynamicPageHeader>
        <f:content>
          <filterBar:FilterBar
            id="filterBar"
            useToolbar="true"
            search="onFilterSearch"
            reset="onFilterClear"
            showClearOnFB="true"
          >
            <filterBar:filterGroupItems>

              <!-- General Search -->
              <filterBar:FilterGroupItem groupName="General" name="GeneralSearch" label="Search"
                visibleInFilterBar="true">
                <filterBar:control>
                  <SearchField
                    id="generalSearchField"
                    placeholder="Search..."
                    search=".onFilterSearch"
                  />
                </filterBar:control>
              </filterBar:FilterGroupItem>
              <!-- Dates: relesase, discontiue -->
              <filterBar:FilterGroupItem groupName="ReleaseDate" name="ReleaseDate"
                label="Release Date"
                visibleInFilterBar="true">
                <filterBar:control>
                  <DynamicDateRange
                    showClearIcon="true"
                    id="releaseDateRange"
                    placeholder="Select date or month/year"
                    change="onReleaseDateChange" />
                </filterBar:control>
              </filterBar:FilterGroupItem>
              <filterBar:FilterGroupItem groupName="DiscontinuedDate" name="DiscontinuedDate"
                label="Discontinued Date" visibleInFilterBar="true">
                <filterBar:control>
                  <DynamicDateRange
                    showClearIcon="true"
                    id="discontinuedDateRange"
                    placeholder="Select date or month/year"
                    change="onDiscontinuedDateChange"
                    standardOptions="DATE,DATERANGE,FROM,TO,TODAY,THISWEEK" />
                </filterBar:control>
              </filterBar:FilterGroupItem>
              <!-- product name suggestions -->
              <filterBar:FilterGroupItem groupName="ProductName" name="ProductName"
                label="Product Name Suggestions"
                visibleInFilterBar="true">
                <filterBar:control>
                  <Input
                    id="productNameInput"
                    placeholder="Search..."
                    submit=".onFilterSearch"
                    showSuggestion="true"
                    showClearIcon="true"
                    suggestionItems="{products>/Products}">
                    <suggestionItems>
                      <core:Item text="{products>Name}" key="{products>ID}" />
                    </suggestionItems>
                  </Input>
                </filterBar:control>
              </filterBar:FilterGroupItem>

              <!-- Supplier value helper -->
              <filterBar:FilterGroupItem groupName="Supplier" name="SupplierNames" label="Supplier"
                visibleInFilterBar="true">
                <filterBar:control>
                  <MultiInput
                    id="supplierInput"
                    valueHelpRequest=".onVHRequested"
                    placeholder="Filter by supplier"
                    showClearIcon="true"
                  />
                </filterBar:control>
              </filterBar:FilterGroupItem>

              <!-- catogries dropdown -->
              <filterBar:FilterGroupItem groupName="Categories" name="CategoryKeys"
                label="Select Categories" visibleInFilterBar="true">
                <filterBar:control>
                  <MultiComboBox
                    id="categoryFilter"
                    selectionChange="handleSelectionChange"
                    selectionFinish="handleSelectionFinish"
                    placeholder="Select categories">
                    <core:Item key="C02" text="Category 2" />
                    <core:Item key="C01" text="Category 1" />
                    <core:Item key="C04" text="Category 4" />
                    <core:Item key="C05" text="Category 5" />
                  </MultiComboBox>
                </filterBar:control>
              </filterBar:FilterGroupItem>
            </filterBar:filterGroupItems>
          </filterBar:FilterBar>
        </f:content>
      </f:DynamicPageHeader>
    </f:header>

    <f:content>
      <Table
        id="productsTable"
        inset="false"
        width="auto"
        mode="MultiSelect"
        selectionChange=".onSelectionChange"
        noDataText="No products available"
        items="{products>/Products}"
        growing="true"
        growingThreshold="20"
      >
        <headerToolbar>
          <Toolbar>
            <Title text="Products" level="H2" />
            <ToolbarSpacer />
            <Button
              text="New Product"
              icon="sap-icon://add"
              press=".onCreatePress"
            />
            <Button
              text="Delete Selected"
              enabled="false"
              id="deleteButton"
              icon="sap-icon://delete"
              press=".onDelete"
            />
          </Toolbar>
        </headerToolbar>
        <columns>
          <Column demandPopin="true" minScreenWidth="Desktop">
            <Text text="ID" />
          </Column>
          <Column demandPopin="true" minScreenWidth="Desktop">
            <Text text="Name" />
          </Column>
          <Column demandPopin="true" minScreenWidth="Desktop">
            <Text text="Release Date" />
          </Column>
          <Column demandPopin="true" minScreenWidth="Desktop">
            <Text text="Discontinued Date" />
          </Column>
          <Column demandPopin="true" minScreenWidth="Desktop">
            <Text text="Price" />
          </Column>
          <Column demandPopin="true" minScreenWidth="Desktop">
            <Text text="Rating" />
          </Column>
          <Column demandPopin="true" minScreenWidth="Desktop">
            <Text text="Supplier" />
          </Column>
          <Column demandPopin="true" minScreenWidth="Desktop">
            <Text text="Categories" />
          </Column>
        </columns>
        <items>
          <ColumnListItem type="Active" press="onRowPress">
            <cells>
              <Text text="{products>ID}" />
              <Text text="{products>Name}" />
              <Text
                text="{
                path: 'products>ReleaseDate',
                type: 'sap.ui.model.type.Date',
                formatOptions: { pattern: 'MM/yyyy' }
              }"
              />
              <Text
                text="{
                 path: 'products>DiscontinuedDate',
                 type: 'sap.ui.model.type.Date',
                 formatOptions: { pattern: 'MM/yyyy' }
              }" />
              <Text text="{products>Price}$" />
              <RatingIndicator displayOnly="true" value="{products>Rating}" iconSize="1rem" />
              <Text text="{products>Supplier/Name}" />
              <Text
                text="{
                path: 'products>Categories',
                formatter: '.formatter.formatCategories'
              }"
              />
            </cells>
          </ColumnListItem>
        </items>
      </Table>
    </f:content>
  </f:DynamicPage>
</mvc:View>